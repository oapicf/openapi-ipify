--  openapi_ipify
--  OpenAPI client for ipify, a simple public IP address API
--
--  The version of the OpenAPI document: 5.3.1_pre.0
--  Contact: blah+oapicf@cliffano.com
--
--  NOTE: This package is auto generated by OpenAPI-Generator 7.6.0.
--  https://openapi-generator.tech
--  Do not edit the class manually.

pragma Warnings (Off, "*is not referenced");
with Swagger.Streams;
with Swagger.Servers.Operation;
package body .Skeletons is
   pragma Style_Checks ("-bmrIu");
   pragma Warnings (Off, "*use clause for package*");

   use Swagger.Streams;

   Mime_1 : aliased constant String := "application/javascript";
   Media_List_1 : aliased constant Swagger.Mime_List := (
     1 => Mime_1'Access,
     
     2 => Swagger.Mime_Json,
     
     3 => Swagger.Mime_Text);

   package body Skeleton is


      package API_Get_Ip is
         new Swagger.Servers.Operation
            (Handler => Get_Ip,
             Method  => Swagger.Servers.GET,
             URI     => URI_Prefix & "/",
             Mimes   => Media_List_1'Access);

      --  Get your public IP address
      procedure Get_Ip
         (Req     : in out Swagger.Servers.Request'Class;
          Reply   : in out Swagger.Servers.Response'Class;
          Stream  : in out Swagger.Servers.Output_Stream'Class;
          Context : in out Swagger.Servers.Context_Type) is
         Impl : Implementation_Type;
         Format : Swagger.Nullable_UString;
         Callback : Swagger.Nullable_UString;
         Result : Swagger.UString;
      begin
         
         Format := To_Swagger.UString (Swagger.Servers.Get_Query_Parameter (Req, "format"));

         Callback := To_Swagger.UString (Swagger.Servers.Get_Query_Parameter (Req, "callback"));

         
         Impl.Get_Ip
            (Format,
             Callback, Result, Context);
         if Context.Get_Status = 200 then
            Context.Set_Description ("Your public IP address");
            Stream.Write (Swagger.To_String (Result));


            return;
         end if;

      end Get_Ip;

      procedure Register (Server : in out Swagger.Servers.Application_Type'Class) is
      begin
         Swagger.Servers.Register (Server, API_Get_Ip.Definition);
      end Register;

   end Skeleton;

   package body Shared_Instance is


      --  Get your public IP address
      procedure Get_Ip
         (Req     : in out Swagger.Servers.Request'Class;
          Reply   : in out Swagger.Servers.Response'Class;
          Stream  : in out Swagger.Servers.Output_Stream'Class;
          Context : in out Swagger.Servers.Context_Type) is
         Format : Swagger.Nullable_UString;
         Callback : Swagger.Nullable_UString;
         Result : Swagger.UString;
      begin
         Format := To_Swagger.UString (Swagger.Servers.Get_Query_Parameter (Req, "format"));
         Callback := To_Swagger.UString (Swagger.Servers.Get_Query_Parameter (Req, "callback"));

         
         Server.Get_Ip
            (Format,
             Callback, Result, Context);
         if Context.Get_Status = 200 then
            Context.Set_Description ("Your public IP address");
            Stream.Write (Swagger.To_String (Result));


            return;
         end if;

      end Get_Ip;

      package API_Get_Ip is
         new Swagger.Servers.Operation
            (Handler => Get_Ip,
             Method  => Swagger.Servers.GET,
             URI     => URI_Prefix & "/",
             Mimes   => Media_List_1'Access);


      procedure Register (Server : in out Swagger.Servers.Application_Type'Class) is
      begin
         Swagger.Servers.Register (Server, API_Get_Ip.Definition);
      end Register;

      protected body Server is
         --  Get your public IP address
         procedure Get_Ip
            (Format : in Swagger.Nullable_UString;
             Callback : in Swagger.Nullable_UString;
             Result : out Swagger.UString;
             Context : in out Swagger.Servers.Context_Type) is
         begin
            Impl.Get_Ip
               (Format,
                Callback,
                Result,
                Context);
         end Get_Ip;

      end Server;

   end Shared_Instance;

end .Skeletons;
